/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

!function(t){var e=function(){};e.prototype=t.extend(e.prototype,{name:"ImportExport",options:{msgImportWarning:"Please choose a file first!"},initialize:function(e,i){this.options=t.extend({},this.options,i);var n=this;e.find("div.uploadbox").each(function(){var e=t(this).find("input.filename");t(this).find('input[name^="import-"]').bind("change",function(){e.val(this.value)});t(this).find("button.upload").bind("click",function(){if(e.val()==""){alert(n.options.msgImportWarning)}else{submitbutton("import")}})});e.find("a.exporter-link").each(function(){var i=t(this);i.bind("click",function(){e.find('input[name="exporter"]').val(i.attr("id"));submitbutton("importfrom")})});e.find("button.export").bind("click",function(){var i=e.find('input[name="format"]');i.val("raw");e.find('input[name="exporter"]').val("zoo2");submitbutton(t(this).data("task"));i.val("html")})}});t.fn[e.prototype.name]=function(){var i=arguments;var n=i[0]?i[0]:null;return this.each(function(){var a=t(this);if(e.prototype[n]&&a.data(e.prototype.name)&&n!="initialize"){a.data(e.prototype.name)[n].apply(a.data(e.prototype.name),Array.prototype.slice.call(i,1))}else if(!n||t.isPlainObject(n)){var o=new e;if(e.prototype["initialize"]){o.initialize.apply(o,t.merge([a],i))}a.data(e.prototype.name,o)}else{t.error("Method "+n+" does not exist on jQuery."+e.name)}})}}(jQuery);!function(t){var e=function(){};e.prototype=t.extend(e.prototype,{name:"Import",options:{msgSelectWarning:"You didn't assign all item types. Items of these types will not be imported. Do you want to proceed anyway?",msgWarningDuplicate:"There are duplicate assignments.",msgNameWarning:"Please choose a name column.",task:"doimport"},initialize:function(e,i){this.options=t.extend({},this.options,i);var n=this;this.form=e;e.find("fieldset.frontpage, fieldset.categories").each(function(){var e=t(this);e.find('input[name^="import-"]').bind("change",function(){if(t(this).is(":checked")){e.find("div.assign-group").show()}else{e.find("div.assign-group").hide()}})});e.find("fieldset.items").each(function(){var e=t(this);e.find("select.type").bind("change",function(){var i=t(this);var n=new RegExp("\\["+i.val()+"\\]$");e.find("li.assign select.assign").each(function(){var e=t(this);if(e.attr("name").match(n)){var i=e.nextAll(".name").text()+" "+e.nextAll(".type").text();e.show().find("option").each(function(){if(t(this).text()==i){e.val(t(this).val())}})}else{e.hide()}})})});t("#submit-button").bind("click",function(){if(n.options.task!="doimportcsv"&&n.hasDuplicateSelectedAssignments()){alert(n.options.msgWarningDuplicate)}else if(n.options.task=="doimportcsv"&&!n.hasNameAssigned()){alert(n.options.msgNameWarning)}else if(n.hasUnassignedTypes()&&!confirm(n.options.msgSelectWarning)){}else{submitbutton(n.options.task)}})},hasNameAssigned:function(){var e=false;this.form.find("div.assign-group").each(function(){var i=new RegExp("\\["+t(this).find("select.type").val()+"\\]$");t(this).find("select.assign").each(function(){if(t(this).attr("name").match(i)&&t(this).val()=="_name"){e=true;return}})});return e},hasUnassignedTypes:function(){var e=false;this.form.find("select.type").each(function(){if(t(this).val()==""){e=true;return}});return e},hasDuplicateSelectedAssignments:function(){var e=false;this.form.find("div.assign-group").each(function(){var n=t(this).find("select.assign");for(i=0;i<n.length;i++){for(j=i+1;j<n.length;j++){value_a=t(n.get(i)).val();value_b=t(n.get(j)).val();if(value_a!=""&&value_a!="_category"&&value_a==value_b){e=true;return}}}});return e}});t.fn[e.prototype.name]=function(){var i=arguments;var n=i[0]?i[0]:null;return this.each(function(){var a=t(this);if(e.prototype[n]&&a.data(e.prototype.name)&&n!="initialize"){a.data(e.prototype.name)[n].apply(a.data(e.prototype.name),Array.prototype.slice.call(i,1))}else if(!n||t.isPlainObject(n)){var o=new e;if(e.prototype["initialize"]){o.initialize.apply(o,t.merge([a],i))}a.data(e.prototype.name,o)}else{t.error("Method "+n+" does not exist on jQuery."+e.name)}})}}(jQuery);