/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

!function(t){var i=function(){};i.prototype=t.extend(i.prototype,{name:"ImportExport",options:{msgImportWarning:"Please choose a file first!"},initialize:function(i,e){this.options=t.extend({},this.options,e);var n=this;i.find("div.uploadbox").each(function(){var i=t(this).find("input.filename");t(this).find('input[name^="import-"]').bind("change",function(){i.val(this.value)});t(this).find("button.upload").bind("click",function(){if(i.val()==""){alert(n.options.msgImportWarning)}else{submitbutton("import")}})});i.find("a.exporter-link").each(function(){var e=t(this);e.bind("click",function(){i.find('input[name="exporter"]').val(e.attr("id"));submitbutton("importfrom")})});i.find("button.export").bind("click",function(){var e=i.find('input[name="format"]');e.val("raw");i.find('input[name="exporter"]').val("zoo2");submitbutton(t(this).data("task"));e.val("html")})}});t.fn[i.prototype.name]=function(){var e=arguments;var n=e[0]?e[0]:null;return this.each(function(){var a=t(this);if(i.prototype[n]&&a.data(i.prototype.name)&&n!="initialize"){a.data(i.prototype.name)[n].apply(a.data(i.prototype.name),Array.prototype.slice.call(e,1))}else if(!n||t.isPlainObject(n)){var o=new i;if(i.prototype["initialize"]){o.initialize.apply(o,t.merge([a],e))}a.data(i.prototype.name,o)}else{t.error("Method "+n+" does not exist on jQuery."+i.name)}})}}(jQuery);!function(t){var e=function(){};e.prototype=t.extend(e.prototype,{name:"Import",options:{msgSelectWarning:"You didn't assign all item types. Items of these types will not be imported. Do you want to proceed anyway?",msgWarningDuplicate:"There are duplicate assignments.",msgNameWarning:"Please choose a name column.",task:"doimport"},initialize:function(i,e){this.options=t.extend({},this.options,e);var n=this;this.form=i;i.find("fieldset.frontpage, fieldset.categories").each(function(){var i=t(this);i.find('input[name^="import-"]').bind("change",function(){if(t(this).is(":checked")){i.find("div.assign-group").show()}else{i.find("div.assign-group").hide()}})});i.find("fieldset.items").each(function(){var i=t(this);i.find("select.type").bind("change",function(){var e=t(this);var n=new RegExp("\\["+e.val()+"\\]$");i.find("li.assign select.assign").each(function(){var i=t(this);if(i.attr("name").match(n)){var e=i.nextAll(".name").text().trim();i.show().find("option").each(function(){if(t(this).text().replace(/\(.*\)/i,"").trim()==e){i.val(t(this).val())}})}else{i.hide()}})})});t("#submit-button").bind("click",function(){if(n.options.task!="doimportcsv"&&n.hasDuplicateSelectedAssignments()){alert(n.options.msgWarningDuplicate)}else if(n.options.task=="doimportcsv"&&!n.hasNameAssigned()){alert(n.options.msgNameWarning)}else if(n.hasUnassignedTypes()&&!confirm(n.options.msgSelectWarning)){}else{submitbutton(n.options.task)}})},hasNameAssigned:function(){var i=false;this.form.find("div.assign-group").each(function(){var e=new RegExp("\\["+t(this).find("select.type").val()+"\\]$");t(this).find("select.assign").each(function(){if(t(this).attr("name").match(e)&&t(this).val()=="_name"){i=true;return}})});return i},hasUnassignedTypes:function(){var i=false;this.form.find("select.type").each(function(){if(t(this).val()==""){i=true;return}});return i},hasDuplicateSelectedAssignments:function(){var e=false;this.form.find("div.assign-group").each(function(){var n=t(this).find("select.assign");for(i=0;i<n.length;i++){for(j=i+1;j<n.length;j++){value_a=t(n.get(i)).val();value_b=t(n.get(j)).val();if(value_a!=""&&value_a!="_category"&&value_a==value_b){e=true;return}}}});return e}});t.fn[e.prototype.name]=function(){var i=arguments;var n=i[0]?i[0]:null;return this.each(function(){var a=t(this);if(e.prototype[n]&&a.data(e.prototype.name)&&n!="initialize"){a.data(e.prototype.name)[n].apply(a.data(e.prototype.name),Array.prototype.slice.call(i,1))}else if(!n||t.isPlainObject(n)){var o=new e;if(e.prototype["initialize"]){o.initialize.apply(o,t.merge([a],i))}a.data(e.prototype.name,o)}else{t.error("Method "+n+" does not exist on jQuery."+e.name)}})}}(jQuery);