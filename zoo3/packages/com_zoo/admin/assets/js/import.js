/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

!function(t){var i=function(){};i.prototype=t.extend(i.prototype,{name:"ImportExport",options:{msgImportWarning:"Please choose a file first!"},initialize:function(i,n){this.options=t.extend({},this.options,n);var e=this;i.find("div.uploadbox").each(function(){var i=t(this).find("input.filename");t(this).find('input[name^="import-"]').bind("change",function(){i.val(this.value)}),t(this).find("button.upload").bind("click",function(){""==i.val()?alert(e.options.msgImportWarning):submitbutton("import")})}),i.find("a.exporter-link").each(function(){var n=t(this);n.bind("click",function(){i.find('input[name="exporter"]').val(n.attr("id")),submitbutton("importfrom")})}),i.find("button.export").bind("click",function(){var n=i.find('input[name="format"]');n.val("raw"),i.find('input[name="exporter"]').val("zoo2"),submitbutton(t(this).data("task")),n.val("html")})}}),t.fn[i.prototype.name]=function(){var n=arguments,e=n[0]?n[0]:null;return this.each(function(){var a=t(this);if(i.prototype[e]&&a.data(i.prototype.name)&&"initialize"!=e)a.data(i.prototype.name)[e].apply(a.data(i.prototype.name),Array.prototype.slice.call(n,1));else if(!e||t.isPlainObject(e)){var o=new i;i.prototype.initialize&&o.initialize.apply(o,t.merge([a],n)),a.data(i.prototype.name,o)}else t.error("Method "+e+" does not exist on jQuery."+i.name)})}}(jQuery),function(t){var n=function(){};n.prototype=t.extend(n.prototype,{name:"Import",options:{msgSelectWarning:"You didn't assign all item types. Items of these types will not be imported. Do you want to proceed anyway?",msgWarningDuplicate:"There are duplicate assignments.",msgNameWarning:"Please choose a name column.",task:"doimport"},initialize:function(i,n){this.options=t.extend({},this.options,n);var e=this;this.form=i,i.find("fieldset.frontpage, fieldset.categories").each(function(){var i=t(this);i.find('input[name^="import-"]').bind("change",function(){t(this).is(":checked")?i.find("div.assign-group").show():i.find("div.assign-group").hide()})}),i.find("fieldset.items").each(function(){var i=t(this);i.find("select.type").bind("change",function(){var n=t(this),e=new RegExp("\\["+n.val()+"\\]$");i.find("li.assign select.assign").each(function(){var i=t(this);if(i.attr("name").match(e)){var n=i.nextAll(".name").text().trim();i.show().find("option").each(function(){t(this).text().replace(/\(.*\)/i,"").trim()==n&&i.val(t(this).val())})}else i.hide()})})}),t("#submit-button").bind("click",function(){"doimportcsv"!=e.options.task&&e.hasDuplicateSelectedAssignments()?alert(e.options.msgWarningDuplicate):"doimportcsv"!=e.options.task||e.hasNameAssigned()?e.hasUnassignedTypes()&&!confirm(e.options.msgSelectWarning)||submitbutton(e.options.task):alert(e.options.msgNameWarning)})},hasNameAssigned:function(){var i=!1;return this.form.find("div.assign-group").each(function(){var n=new RegExp("\\["+t(this).find("select.type").val()+"\\]$");t(this).find("select.assign").each(function(){return t(this).attr("name").match(n)&&"_name"==t(this).val()?void(i=!0):void 0})}),i},hasUnassignedTypes:function(){var i=!1;return this.form.find("select.type").each(function(){return""==t(this).val()?void(i=!0):void 0}),i},hasDuplicateSelectedAssignments:function(){var n=!1;return this.form.find("div.assign-group").each(function(){var e=t(this).find("select.assign");for(i=0;i<e.length;i++)for(j=i+1;j<e.length;j++)if(value_a=t(e.get(i)).val(),value_b=t(e.get(j)).val(),""!=value_a&&"_category"!=value_a&&value_a==value_b)return void(n=!0)}),n}}),t.fn[n.prototype.name]=function(){var i=arguments,e=i[0]?i[0]:null;return this.each(function(){var a=t(this);if(n.prototype[e]&&a.data(n.prototype.name)&&"initialize"!=e)a.data(n.prototype.name)[e].apply(a.data(n.prototype.name),Array.prototype.slice.call(i,1));else if(!e||t.isPlainObject(e)){var o=new n;n.prototype.initialize&&o.initialize.apply(o,t.merge([a],i)),a.data(n.prototype.name,o)}else t.error("Method "+e+" does not exist on jQuery."+n.name)})}}(jQuery);