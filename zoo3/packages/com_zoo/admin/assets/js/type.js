/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

!function(e){var t=function(){};e.extend(t.prototype,{name:"EditElements",options:{url:"index.php?option=com_zoo&controller=manager",msgNoElements:"No elements defined for this type",msgDeletelog:"Are you sure you want to delete the element?"},initialize:function(t,i){this.options=e.extend({},this.options,i);var n=this;this.list=t,this.count=0,this.noElements(),this.list.delegate("div.edit-event","click",function(){e(this).parent("li.element").toggleClass("hideconfig")}).delegate("div.delete-event","click",function(){confirm(n.options.msgDeletelog)&&e(this).parent("li.element").fadeOut(200,function(){e(this).remove(),n.noElements()})}).sortable({handle:"div.sort-event",placeholder:"element dragging",axis:"y",delay:100,tolerance:"pointer",scroll:!1,start:function(t,i){n.list.children("li.element").each(function(){e(this).data("showconfig",!e(this).hasClass("hideconfig")),e(this).addClass("hideconfig")});var o=e("div.name",i.item).height();i.helper.height(o),i.placeholder.height(o),e(this).sortable("refreshPositions")},stop:function(t,i){n.list.children("li.element").each(function(){e(this).data("showconfig")&&e(this).removeClass("hideconfig")})}}),e("#add-element ul.elements li").bind("click",function(){var t=e("<li>").addClass("element loading").prependTo(n.list);e.ajax({url:n.options.url,data:{format:"raw",task:"addelement",element:e(this).attr("class"),count:n.count++},dataType:"html",success:function(e){t.removeClass("loading").html(e),new Tips(t.find(".hasTip").get(),{maxTitleChars:50,fixed:!1}),n.noElements(),n.list.trigger("element.added",t),t.slideDown(200).effect("highlight",{},1e3)}})}),e(".core-element-configuration > ul").hide(),e(".core-element-configuration > .toggler").bind("click",function(t){t.preventDefault(),e(".core-element-configuration > ul").toggle()}),e(".core-element-configuration").delegate("div.edit-event","click",function(){e(this).parent("li.element").toggleClass("hideconfig")})},noElements:function(){this.list.find("li.no-elements").remove(),0==this.list.children("li.element").length&&e("<li>").addClass("no-elements").text(this.options.msgNoElements).appendTo(this.list)}}),e.fn[t.prototype.name]=function(){var i=arguments,n=i[0]?i[0]:null;return this.each(function(){var o=e(this);if(t.prototype[n]&&o.data(t.prototype.name)&&"initialize"!=n)o.data(t.prototype.name)[n].apply(o.data(t.prototype.name),Array.prototype.slice.call(i,1));else if(!n||e.isPlainObject(n)){var a=new t;t.prototype.initialize&&a.initialize.apply(a,e.merge([o],i)),o.data(t.prototype.name,a)}else e.error("Method "+n+" does not exist on jQuery."+t.name)})}}(jQuery),function(e){var t=function(){};e.extend(t.prototype,{name:"AssignElements",initialize:function(t){var i=this;e("ul.element-list").delegate("div.sort-event","mousedown",function(){e("li.element").not(".hideconfig").addClass("hideconfig")}),e("ul.element-list:not(.unassigned)").sortable({handle:"div.sort-event",connectWith:"ul.element-list:not(.unassigned)",placeholder:"element hideconfig dragging",forcePlaceholderSize:!0,cursorAt:{top:16},tolerance:"pointer",scroll:!1,change:function(e,t){i.emptyList()},update:function(n,o){o.item.hasClass("assigning")&&(t.find("li.assigning").each(function(){if(e(this).data("config")){var t=e(this).data("config").clone();t.find("input:radio").each(function(){e(this).attr("name",e(this).attr("name").replace(/^elements\[[\w_-]+\]/,"elements[_temp]"))}),o.item.append(t)}}),o.item.removeClass("assigning")),i.emptyList()},start:function(e,t){t.helper.addClass("ghost")},stop:function(e,t){t.item.removeClass("ghost"),i.emptyList().sanatizeList()}}),e("ul.element-list.unassigned li.element").draggable({handle:"div.sort-event",scroll:!1,zIndex:1e3,helper:function(){var t=e(this).clone();return t.find("div.config").remove(),t},connectToSortable:"ul.element-list:not(.unassigned)",drag:function(e,t){i.emptyList()},start:function(t,i){e(this).addClass("assigning"),e(this).data("config",e(this).find("div.config").remove()),i.helper.addClass("ghost")},stop:function(t,n){e(this).removeClass("assigning"),n.helper.removeClass("ghost"),e(this).append(e(this).data("config")),i.emptyList().sanatizeList()}}),this.emptyList().sanatizeList(),t.delegate("div.edit-event","click",function(){e(this).closest("li").toggleClass("hideconfig")}).delegate("div.delete-event","click",function(){e(this).closest("li").fadeOut(200,function(){e(this).remove(),i.emptyList().sanatizeList()})})},emptyList:function(){return e("ul.element-list:not(.unassigned)").each(function(){var t=e(this).hasClass("empty-list"),i=e(this).children(":not(.ui-sortable-helper)").length;(t&&i||!t&&!i)&&e(this).toggleClass("empty-list")}),this},sanatizeList:function(){var t=new RegExp(/(elements\[[a-z0-9_-]+\])|(positions\[[a-z0-9_-]+\]\[[0-9]+\])/);return e("ul.element-list:not(.unassigned)").each(function(){var i="positions["+e(this).data("position")+"]";e(this).children().each(function(n){e(this).find("[name^=positions], [name^=elements]").each(function(){e(this).attr("name","tmp"+e(this).attr("name").replace(t,i+"["+n+"]"))})})}),t=new RegExp(/^tmp/),e("ul.element-list").find("[name^=tmp]").each(function(){e(this).attr("name",e(this).attr("name").replace(t,""))}),this}}),e.fn[t.prototype.name]=function(){var i=arguments,n=i[0]?i[0]:null;return this.each(function(){var o=e(this);if(t.prototype[n]&&o.data(t.prototype.name)&&"initialize"!=n)o.data(t.prototype.name)[n].apply(o.data(t.prototype.name),Array.prototype.slice.call(i,1));else if(!n||e.isPlainObject(n)){var a=new t;t.prototype.initialize&&a.initialize.apply(a,e.merge([o],i)),o.data(t.prototype.name,a)}else e.error("Method "+n+" does not exist on jQuery."+t.name)})}}(jQuery),function(e){var t=function(){};e.extend(t.prototype,{name:"AssignSubmission",initialize:function(t){var i=this;e("ul.element-list").delegate("div.sort-event","mousedown",function(){e("li.element").not(".hideconfig").addClass("hideconfig")}).sortable({handle:"div.sort-event",connectWith:'ul.element-list:not([data-position="unassigned"])',placeholder:"element hideconfig dragging",forcePlaceholderSize:!0,cursorAt:{top:16},tolerance:"pointer",scroll:!1,start:function(e,t){t.helper.addClass("ghost")},stop:function(e,t){t.item.removeClass("ghost")},change:function(e,t){i.emptyList()},update:function(e,t){i.emptyList()}}),this.emptyList(),t.delegate("div.edit-event","click",function(){e(this).closest("li").toggleClass("hideconfig")}).delegate("div.delete-event","click",function(){e(this).closest("li").appendTo(e("ul.element-list[data-position=unassigned]")).addClass("hideconfig").effect("highlight",{},1e3),i.emptyList()}),e.each(["apply","save","save-new"],function(t,i){e("#toolbar-"+i+" a, #toolbar-"+i+" button").bind("validate.adminForm",function(t){e('ul.element-list:not([data-position="unassigned"])').each(function(){var t=e(this).data("position");e(this).children().each(function(i){var n=e(this).data("element");e(this).find('[name^="'+n+'"]').each(function(){e(this).attr("name","positions["+t+"]["+i+"]"+e(this).attr("name").replace(new RegExp(n),""))})})})})})},emptyList:function(){return e("ul.element-list").each(function(){e(this).removeClass("empty-list"),0==e(this).children(":not(.ui-sortable-helper)").length&&e(this).addClass("empty-list")}),this}}),e.fn[t.prototype.name]=function(){var i=arguments,n=i[0]?i[0]:null;return this.each(function(){var o=e(this);if(t.prototype[n]&&o.data(t.prototype.name)&&"initialize"!=n)o.data(t.prototype.name)[n].apply(o.data(t.prototype.name),Array.prototype.slice.call(i,1));else if(!n||e.isPlainObject(n)){var a=new t;t.prototype.initialize&&a.initialize.apply(a,e.merge([o],i)),o.data(t.prototype.name,a)}else e.error("Method "+n+" does not exist on jQuery."+t.name)})}}(jQuery),function(e){var t=function(){};e.extend(t.prototype,{name:"EditType",initialize:function(t){e.each(["apply","save"],function(i,n){e("#toolbar-"+n+" a").removeAttr("onclick").bind("click",function(e){""==t.find('input[name="name"]').val()?t.find("span.message-name").css("display","block"):submitbutton(n+"type")})})}}),e.fn[t.prototype.name]=function(){var i=arguments,n=i[0]?i[0]:null;return this.each(function(){var o=e(this);if(t.prototype[n]&&o.data(t.prototype.name)&&"initialize"!=n)o.data(t.prototype.name)[n].apply(o.data(t.prototype.name),Array.prototype.slice.call(i,1));else if(!n||e.isPlainObject(n)){var a=new t;t.prototype.initialize&&a.initialize.apply(a,e.merge([o],i)),o.data(t.prototype.name,a)}else e.error("Method "+n+" does not exist on jQuery."+t.name)})}}(jQuery);