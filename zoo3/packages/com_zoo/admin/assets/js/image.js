/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

jQuery(function(e){var t=location.href.match(/^(.+)administrator\/index\.php.*/i)[1];e("input.image-select").each(function(i){var n=e(this);var a="image-select-"+i;var r=e('<button type="button">').text("Select Image").insertAfter(n);var o=e("<span>").addClass("image-cancel").insertAfter(n);var s=e("<div>").addClass("image-preview").insertAfter(r);n.attr("id",a);if(n.val()){e("<img>").attr("src",t+n.val()).appendTo(s)}o.click(function(){n.val("");s.empty()});r.click(function(e){e.preventDefault();SqueezeBox.fromElement(this,{handler:"iframe",url:"index.php?option=com_media&view=images&tmpl=component&e_name="+a,size:{x:800,y:500}})})});if(e.isFunction(window.jInsertEditorText)){window.insertTextOld=window.jInsertEditorText}window.jInsertEditorText=function(i,n){if(n.match(/^image-select-/)){var a=e("#"+n);var r=i.match(/src="([^\"]*)"/)[1];var o=a.parent().find("div.image-preview").html(i);var s=o.find("img");s.attr("src",t+r);a.val(r)}else if(e.isFunction(window.insertTextOld)){window.insertTextOld(i,n)}}});