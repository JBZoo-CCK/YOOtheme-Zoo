/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

(function($){var Plugin=function(){};$.extend(Plugin.prototype,{name:"BrowseTags",options:{msgSave:"Save",msgCancel:"Cancel"},initialize:function(input,options){this.options=$.extend({},this.options,options);var $this=this;this.input=input;input.find("span.edit-tag a").bind("click",function(){var trigger=$(this);$this.removePanel();trigger.hide();var panel=$("<span>").addClass("edit-tag-panel").insertAfter(trigger);$('<input class="text" type="text" name="new">').val(trigger.text()).appendTo(panel).focus().bind("keydown",function(event){if(event.which==13){event.stopPropagation();$this.submit()}if(event.which==27){event.stopPropagation();$this.removePanel()}});$('<input type="hidden" name="old">').val(trigger.text()).appendTo(panel);$("<button>").addClass("save").text($this.options.msgSave).appendTo(panel).bind("click",function(){$this.submit()});$("<a>").addClass("cancel").text($this.options.msgCancel).appendTo(panel).bind("click",function(){$this.removePanel()})})},removePanel:function(){this.input.find("span.edit-tag-panel").each(function(){$(this).parent().find("a").show();$(this).remove()})},submit:function(){this.input.find('input[name="task"]').val("update");this.input.submit()}});$.fn[Plugin.prototype.name]=function(){var args=arguments;var method=args[0]?args[0]:null;return this.each(function(){var element=$(this);if(Plugin.prototype[method]&&element.data(Plugin.prototype.name)&&method!="initialize"){element.data(Plugin.prototype.name)[method].apply(element.data(Plugin.prototype.name),Array.prototype.slice.call(args,1))}else if(!method||$.isPlainObject(method)){var plugin=new Plugin;if(Plugin.prototype["initialize"]){plugin.initialize.apply(plugin,$.merge([element],args))}element.data(Plugin.prototype.name,plugin)}else{$.error("Method "+method+" does not exist on jQuery."+Plugin.name)}})}})(jQuery);(function($){var Plugin=function(){};$.extend(Plugin.prototype,{name:"Tag",options:{url:"",addButtonText:"Add Tag"},initialize:function(tagArea,options){this.options=$.extend({},this.options,options);var $this=this;var cache={},lastXhr;this.tagArea=tagArea;this.tagInput=tagArea.find('input[type="text"]');this.tagInput.autosuggest($.extend({allowDuplicates:false,inputName:"tags[]",prefill:this.tagInput.val()!=this.tagInput.attr("placeholder")?this.tagInput.val():"",source:function(request,response){var term=request.term;if(term in cache){response(cache[term]);return}lastXhr=$.getJSON($this.options.url,{tag:term},function(data,status,xhr){cache[term]=data;if(xhr===lastXhr)response(data)})}},this.options)).bind("keydown",function(event){switch(event.which){case 13:event.preventDefault();$this.tagInput.autosuggest("addItem",$this.tagInput.val());break}}).placeholder();tagArea.delegate("div.tag-cloud a","click",function(){$this.tagInput.autosuggest("addItem",$(this).text());$this.tagInput.trigger("blur.placeholder")})}});$.fn[Plugin.prototype.name]=function(){var args=arguments;var method=args[0]?args[0]:null;return this.each(function(){var element=$(this);if(Plugin.prototype[method]&&element.data(Plugin.prototype.name)&&method!="initialize"){element.data(Plugin.prototype.name)[method].apply(element.data(Plugin.prototype.name),Array.prototype.slice.call(args,1))}else if(!method||$.isPlainObject(method)){var plugin=new Plugin;if(Plugin.prototype["initialize"]){plugin.initialize.apply(plugin,$.merge([element],args))}element.data(Plugin.prototype.name,plugin)}else{$.error("Method "+method+" does not exist on jQuery."+Plugin.name)}})}})(jQuery);