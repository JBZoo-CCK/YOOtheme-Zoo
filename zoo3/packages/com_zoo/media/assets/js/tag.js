/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

(function(t){var e=function(){};t.extend(e.prototype,{name:"BrowseTags",options:{msgSave:"Save",msgCancel:"Cancel"},initialize:function(e,n){this.options=t.extend({},this.options,n);var a=this;this.input=e;e.find("span.edit-tag a").bind("click",function(){var e=t(this);a.removePanel();e.hide();var n=t("<span>").addClass("edit-tag-panel").insertAfter(e);t('<input class="text" type="text" name="new">').val(e.text()).appendTo(n).focus().bind("keydown",function(t){if(t.which==13){t.stopPropagation();a.submit()}if(t.which==27){t.stopPropagation();a.removePanel()}});t('<input type="hidden" name="old">').val(e.text()).appendTo(n);t("<button>").addClass("save").text(a.options.msgSave).appendTo(n).bind("click",function(){a.submit()});t("<a>").addClass("cancel").text(a.options.msgCancel).appendTo(n).bind("click",function(){a.removePanel()})})},removePanel:function(){this.input.find("span.edit-tag-panel").each(function(){t(this).parent().find("a").show();t(this).remove()})},submit:function(){this.input.find('input[name="task"]').val("update");this.input.submit()}});t.fn[e.prototype.name]=function(){var n=arguments;var a=n[0]?n[0]:null;return this.each(function(){var i=t(this);if(e.prototype[a]&&i.data(e.prototype.name)&&a!="initialize"){i.data(e.prototype.name)[a].apply(i.data(e.prototype.name),Array.prototype.slice.call(n,1))}else if(!a||t.isPlainObject(a)){var o=new e;if(e.prototype["initialize"]){o.initialize.apply(o,t.merge([i],n))}i.data(e.prototype.name,o)}else{t.error("Method "+a+" does not exist on jQuery."+e.name)}})}})(jQuery);(function(t){var e=function(){};t.extend(e.prototype,{name:"Tag",options:{url:"",addButtonText:"Add Tag"},initialize:function(e,n){this.options=t.extend({},this.options,n);var a=this;var i={},o;this.tagArea=e;this.tagInput=e.find('input[type="text"]');this.tagInput.autosuggest(t.extend({allowDuplicates:false,inputName:"tags[]",prefill:this.tagInput.val()!=this.tagInput.attr("placeholder")?this.tagInput.val():"",source:function(e,n){var p=e.term;if(p in i){n(i[p]);return}o=t.getJSON(a.options.url,{tag:p},function(t,e,a){i[p]=t;if(a===o)n(t)})}},this.options)).bind("keydown",function(t){switch(t.which){case 13:t.preventDefault();a.tagInput.autosuggest("addItem",a.tagInput.val());break}}).placeholder();e.delegate("div.tag-cloud a","click",function(){a.tagInput.autosuggest("addItem",t(this).text());a.tagInput.trigger("blur.placeholder")})}});t.fn[e.prototype.name]=function(){var n=arguments;var a=n[0]?n[0]:null;return this.each(function(){var i=t(this);if(e.prototype[a]&&i.data(e.prototype.name)&&a!="initialize"){i.data(e.prototype.name)[a].apply(i.data(e.prototype.name),Array.prototype.slice.call(n,1))}else if(!a||t.isPlainObject(a)){var o=new e;if(e.prototype["initialize"]){o.initialize.apply(o,t.merge([i],n))}i.data(e.prototype.name,o)}else{t.error("Method "+a+" does not exist on jQuery."+e.name)}})}})(jQuery);